# 胜率与仓位的博弈：一个高胜率游戏的量化分析指南

做投资和交易，大多数人把精力花在"怎么提高胜率"上。但真正决定你能不能活到赚钱那天的，是**仓位控制**。这篇文章用一个简单的抛硬币游戏，从数学期望到凯利公式，把仓位管理的底层逻辑讲清楚。

---

## 游戏规则与问题定义

假设你手握 **10,000 元 (1w)** 初始本金，面临一个极其诱人的抛硬币游戏：

- **赢的概率（胜率）**：70%
- **输的概率（败率）**：30%
- **赔率与收益**：如果你押注 100 元，赢了净赚 70 元，输了亏损 100 元本金（盈亏比为 0.7:1）

**终极目标**：在保证本金不被亏没（绝对破产）的前提下，尽可能快地实现资金翻倍（达到 20,000 元）。

**核心问题**：每一次，你应该押注多少钱？

---

## 第一层思维：这个游戏值得玩吗？

在决定押注多少之前，先算清楚这个游戏的**数学期望 (Expected Value, EV)**。期望值决定了这个游戏长期来看是"印钞机"还是"碎钞机"。

单次押注 100 元的数学期望：

$$
EV = 0.7 \times 70 - 0.3 \times 100 = 49 - 30 = +19 \text{ 元}
$$

**结论**：平均每押注 100 元，你能净赚 19 元。这是一个带有巨大"正向收益预期"的游戏。只要玩得次数足够多，赚钱是必然的。

---

## 第二层思维：生存与效率的天然互斥

既然游戏必赚钱，那是不是押得越大越好？这里就触及了投资和赌博中最核心的矛盾：**破产风险 vs. 翻倍速度**。

不同的押注策略可以分为三种典型模式：

### 模式 A：极度保守派（每次固定押注 100 元）

| 指标 | 数值 |
|------|------|
| 单次仓位 | 1%（100 / 10,000）|
| 破产概率 | **无限接近 0%** |
| 翻倍所需步数 | **约 526 步** |

你拥有 100 次的容错率，配合 70% 的高胜率，本金几乎不可能被击穿。每次平均赚 19 元，要赚够 10,000 元，平均需要约 526 步。

**评价**：绝对安全，但极其低效。资金的时间成本太高。

### 模式 B：极端激进派（每次全仓押注 10,000 元）

| 指标 | 数值 |
|------|------|
| 单次仓位 | 100%（All-in）|
| 破产概率 | **30%**（第一把就可能出局）|
| 翻倍所需步数 | 运气好的话 **2 步** |

第一把只要遇上那 30% 的败率，你直接出局（触发"吸收壁"），游戏结束。

**评价**：典型的"俄罗斯轮盘赌"。即使游戏对你极度有利，只要存在单次让你彻底出局的风险，这就不是一个可以长期执行的策略。

### 模式 C：寻找黄金甜点区（固定押注的最优解）

为了在"不破产"和"快速翻倍"之间找到平衡，需要一个固定押注的最佳金额。经过数学推演，**黄金甜点区在 1,500 元 ~ 2,500 元之间**。

以每次固定押注 2,000 元为例：

| 指标 | 数值 |
|------|------|
| 单次仓位 | 20%（2,000 / 10,000）|
| 破产概率 | **极低**（约万分之几）|
| 翻倍所需步数 | **约 26 步** |

破产需要开局直接连输 5 把，概率为 $0.3^5 = 0.00243$（千分之二）。每次押注 2,000，期望收益为 $2000 \times 0.19 = 380$ 元，赚满 10,000 元平均只需约 26 步。

**评价**：固定金额下最完美的策略。破产率趋近于 0，效率比押注 100 元快了整整 20 倍。

---

## 终极思维：动态押注的绝对最优解——凯利公式

如果规则允许你**随意设定押注金额，且不局限于固定数字**，数学界给出了一个绝对的标准答案：**凯利公式 (Kelly Criterion)**。

凯利公式的精髓在于：随着你资金的变动，动态调整押注比例，从而实现资金复合增长率的最大化。

### 公式推导

$$
f^* = \frac{p}{1} - \frac{q}{b}
$$

其中：

- $b$（盈亏比）= 70 / 100 = 0.7
- $p$（胜率）= 0.7
- $q$（败率）= 0.3

代入计算：

$$
f^* = \frac{0.7}{1} - \frac{0.3}{0.7} = 0.7 - 0.4286 = 0.2714
$$

### 全凯利动态策略执行方案

| 指标 | 数值 |
|------|------|
| 策略 | 每次押注**当前总资金的 27.14%** |
| 破产概率 | **0%** |
| 翻倍所需步数 | **约 26 步** |

- 第一把有 10,000，押注 2,714
- 如果赢了，总资金变成 11,899.8，第二把押注 3,229
- 依此类推...

因为每次下的都是剩余资金的比例，在数学上资金永远只会被细分，**绝不会被一次性扣成零**。

---

## 蒙特卡洛模拟验证

上面的分析都是数学推演，现在用蒙特卡洛模拟直接跑出来看。对每一个下注比例（1%~100%），各跑 10,000 次 × 300 轮的模拟，统计三个核心指标：

- 🟢 **翻倍概率**（绿色实线）— 资金翻倍到 20,000 的成功率
- 🔴 **破产概率**（红色实线）— 资金归零出局的概率
- 🔵 **翻倍中位轮数**（蓝色虚线，右轴）— 成功翻倍所需的中位轮数

![不同下注金额下的翻倍概率 vs 破产概率 vs 翻倍轮数](/images/finance/kelly_double_vs_bankrupt.png)

图中几个关键发现：

1. **下注 7%~20% 区间**翻倍概率接近 100%，破产率几乎为 0——这就是"黄金甜点区"。
2. **凯利最优 27.14%** 处于翻倍概率仍然很高、破产率刚开始抬头的临界点。固定下注 27% 的破产率约 10%，但动态凯利（按比例下注）的破产率为 0%。
3. 超过 30% 之后，翻倍概率快速下降，破产率加速攀升——**仓位过重就是自杀**。
4. 全仓梭哈（100%）时翻倍概率约 60%，破产率约 40%——这已经是赌徒行为了。

---

## 核心总结

### 1. 高胜率 ≠ 不破产

只要仓位过重（比如一把梭哈），再高的胜率也会大概率死于局部的运气波动（黑天鹅）。**生存永远在收益之前。**

### 2. 固定金额的最优解：20%

如果你不想每局按计算器算比例，每次固定押注初始资金的 20%（2,000 元），是兼顾不破产与最快翻倍的"实战派"首选。

### 3. 动态比例的最优解：27.14%

如果你追求纯数学意义上的完美复利增长，请严格执行凯利公式，每次押注总资产的 27.14%。

### 4. 一句话

> **利润来自于正向的期望值，而能否活到利润兑现，完全取决于你的仓位控制。**

这和量化投资的道理完全一致——策略的正期望（alpha）是赚钱的前提，但能不能坚持执行到 alpha 兑现，取决于你的仓位管理和风险控制。回测告诉你"赚多少"，仓位管理告诉你"活多久"。

---

*2026 年 2 月 15 日整理。个人学习笔记，不构成投资建议。*
